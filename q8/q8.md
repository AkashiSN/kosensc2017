# Weak RSA1 [Crypto / 200pt]

## Question

How can you break RSA encryption?

```plain
N=p*q
N=708835645943129007553787748743052450284689712410426547512316767085575465605119005363650712704600637109742020195664779931723202832258101240001830121116826860530911023234513730472516558777814474462336333911255324914456970682227084440864891924652593288718973397231251405187335499086751830864753433190350164325435032715196910424344510647893815852428647344971704921938731908848357904590440836622846387392293484370066978446786342914652887905285420452755025164957938321609211830540625620731059401509554003495572595019530165615150268697998771117466990191657016270154492999047417119200543841703801794754017405828083549512181079778484484615833296517041946343398446543929269190267776468727286950763524356091960754388033790771893614211534472337346760709886751505777124848191879137282566717724907881520331796633675057820305038857638609740587193420413455833780473620895200969157817532381746316713116260790229097467695197707645818454306163146665197104753240563079731816779982948701228425085116143519545288954089301901246726186900866685375686284581170642773173724037083247792412468413122298776580153785011292141836456154851500673520085811180879739085766980682690423420251500193172436971000422462776701950480180278285119551587611145499207507237988346524450766967956800772566583568509014882011261077172582310325249831361444584463311832099011527801981194884188239014074127567832579993356109054176333166246338443112763604171839815616178591855308668331998036506593088919047634704264243653775766416884505796755731347878951615701638493886432384698293311079368594952174744155992630039974548983627962173357913806142325163964058180849459998441282429283597135609560729172257355324952390461646717198519551797147369587725325914917663985378963699085381164957289206289790437421994261624932840318105798488050745844673523206172189595340592904205625131517244444161846326215811938527262896842456518748476369372599194582350826419176968609083709232146591659981863052604049246675088415621890060736119217509998775889668347700707715496820780517044443056539542021216759933629382013817643664151620565621489965296266859088600879618054884697023541183586764128250025571103792415266989521147417622218718913326703763590792865947193450841774068689228271097294760531115108569075371337362597498143641843525557229011848404533432494762643735138582308063659307378987402403699137056572585538563072301956067855139155417070021462789594467575592008021731705856812901700315429830350298084022627452025491759562178546139175191
e=65537
encrypted=answer^e mod N
encrypted=322591498436715958267123572331821134150782373312833612839868183972091497982522254502424703763680659677893580964800124481263656959329041291844931668907981922006294103874302732687771819867000536689111356798002868160412794703860510237214982332623166399791417515634447020777381291741572737475286482402387955568889860510849006181393582267895241983435081092928516146998952546428070356040591091222441571867478829518636745305099389438685499218345311994949366919533514405992167085132436891484719016423868695322095917937144662286686217298236276116502520729941863146291264419980598215299252638364165284561254505052002144225466764890757999340140354815464968914936807483007747763886319359114988020257094791265015476752896816097950499965164665977121072166478126912120191392995885145200726215495052864443599128632447565778113815630862450213198452009283092913820408534896668488757491895594648773475785868743126248865425766947486231885139754067677679827694497407359847002677286914721642080941734074460943717871300727749822488142627660764738931958916578321284940201507349732431865836849470962992660046726630071482205862854896889195384873074978811924398337810859493338888261335608783350859787865548780506929817424121255645044201849812769167381897899206746107940295774070330426141651969490214497458005160894425610680133408097838834931727791441395416689419921586590681939321450680557294644409919786941603526584011483778725713049354543103036628579264137838954115739825810972922036452290642942236775326105221928012882298412629475537706011373606039987837193516925395716996853699337643574189871597092015416413752858780921477119574249340124798992734911070210480513174897301529125757244949387967978001807262978313292663786959333781191335400826006687721998743273129166799171608640918975412729011024061862647570404529985539097149638757568912297491240814100203576132054757632195787968575563075756264486023869531128474496931760838717540249214969524461207774205198875202110020756467071969113970323966817925318851593263086247564335366362069410094398508600362343917062595405077173752873314436451952590173559216945445565839606290258399932695171063789349256390786893722367088255092230898694970298024489038426764778465976027101972512270119323733892682901197765302022045782939507651873114503747563993086728941094162883399015462941621232002246651161343018967033948698908356146449606626585769992033211448852494683033821439838864135940763020321840118595502690340488287721845554876362565957127643512854358250
```

# Answer

`RSA`系の問題のツールが公開されてるのでこれを使ってみよう！

[RsaCtfTool - GitHub](https://github.com/Ganapati/RsaCtfTool)
>RSA tool for ctf - uncipher data from weak public key and try to recover private key Automatic selection of best attack for the given public key

Requirements:

- GMPY
- SymPy
- libnum [https://github.com/hellman/libnum.git](https://github.com/hellman/libnum.git)
- PyCrypto
- Requests
- SageMath - optional but advisable

Python2でしか動かないっぽい

```bash
$ python -V
Python 2.7.14
```

```bash
# for GMPY
$ sudo apt install libgmp3-dev
$ sudo apt install libmpfr-dev libmpfr-doc libmpfr4 libmpfr4-dbg
$ sudo apt install libmpc-dev
# install requirements
$ pip install PyCrypto GMPY SymPy requests
# install libnum
$ git clone git@github.com:hellman/libnum.git 
$ cd libnum
$ python setup.py install
```

使ってみる

```plain
$ git clone git@github.com:Ganapati/RsaCtfTool.git
$ cd RsaCtfTool
$ python RsaCtfTool.py -h
usage: RsaCtfTool.py [-h] (--publickey PUBLICKEY | --createpub | --dumpkey)
                     [--uncipher UNCIPHER] [--verbose] [--private]
                     [--ecmdigits ECMDIGITS] [--n N] [--e E] [--key KEY]

RSA CTF Tool Continued

optional arguments:
  -h, --help            show this help message and exit
  --publickey PUBLICKEY
                        public key file. You can use wildcards for multiple
                        keys.
  --createpub           Take n and e from cli and just print a public key then
                        exit
  --dumpkey             Just dump the RSA variables from a key - n,e,d,p,q
  --uncipher UNCIPHER   uncipher a file
  --verbose             verbose mode (display n, e, p and q)
  --private             Display private key if recovered
  --ecmdigits ECMDIGITS
                        Optionally an estimate as to how long one of the
                        primes is for ECM method
  --n N                 Specify the modulus in --createpub mode.
  --e E                 Specify the public exponent in --createpub mode.
  --key KEY             Specify the input key file in --dumpkey mode.
```

あとはいい感じにパスに通して

一回公開鍵を作ってから攻撃するようなので

```bash
$ RsaCtfTool --createpub --n 708835645943129007553787748743052450284689712410426547512316767085575465605119005363650712704600637109742020195664779931723202832258101240001830121116826860530911023234513730472516558777814474462336333911255324914456970682227084440864891924652593288718973397231251405187335499086751830864753433190350164325435032715196910424344510647893815852428647344971704921938731908848357904590440836622846387392293484370066978446786342914652887905285420452755025164957938321609211830540625620731059401509554003495572595019530165615150268697998771117466990191657016270154492999047417119200543841703801794754017405828083549512181079778484484615833296517041946343398446543929269190267776468727286950763524356091960754388033790771893614211534472337346760709886751505777124848191879137282566717724907881520331796633675057820305038857638609740587193420413455833780473620895200969157817532381746316713116260790229097467695197707645818454306163146665197104753240563079731816779982948701228425085116143519545288954089301901246726186900866685375686284581170642773173724037083247792412468413122298776580153785011292141836456154851500673520085811180879739085766980682690423420251500193172436971000422462776701950480180278285119551587611145499207507237988346524450766967956800772566583568509014882011261077172582310325249831361444584463311832099011527801981194884188239014074127567832579993356109054176333166246338443112763604171839815616178591855308668331998036506593088919047634704264243653775766416884505796755731347878951615701638493886432384698293311079368594952174744155992630039974548983627962173357913806142325163964058180849459998441282429283597135609560729172257355324952390461646717198519551797147369587725325914917663985378963699085381164957289206289790437421994261624932840318105798488050745844673523206172189595340592904205625131517244444161846326215811938527262896842456518748476369372599194582350826419176968609083709232146591659981863052604049246675088415621890060736119217509998775889668347700707715496820780517044443056539542021216759933629382013817643664151620565621489965296266859088600879618054884697023541183586764128250025571103792415266989521147417622218718913326703763590792865947193450841774068689228271097294760531115108569075371337362597498143641843525557229011848404533432494762643735138582308063659307378987402403699137056572585538563072301956067855139155417070021462789594467575592008021731705856812901700315429830350298084022627452025491759562178546139175191 --e 65537 > pubkey
$ cat pubkey 
-----BEGIN PUBLIC KEY-----
MIIEIjANBgkqhkiG9w0BAQEFAAOCBA8AMIIECgKCBAEApl1ZUHcqfa1yZcQ9/h/J
WFNiUbV8XP96BjHcpYD/Wv7L1nQZFn9LNB2PHiB96Xd/Nk+jL42HnWlULiQCbRdt
XGoTQbQshWh5PXcN4lYMkvCvCafrPvwMsVHQSC3O0cckU3LpeOV2FIS90Um33WEH
wCtMu9dBmqnouwNJPp0AXzMYS4J4OvzHYDEstSNZ0s10pyCLhRWr/eux5MNyht9c
e0o8gGFEDUUmrrFyLIgIlMU02rP5A8r+J21ZX6lRWwtGCJVRhBNZbfUgEINsEeQW
9CJakCmw7Hzo3NkDJYJ3Rxm2OApGMtV0lE/7O+dM5Bv5JPkUBJ0+wm/PlceFkn9b
Wj/9z9Fqz0JN2hawAY4w3gryzWwEhmNJDNuBwLa3CW4aZ+Q9vPDE+32uPzNV8cMj
tsWZtCeFU7LmWXuSuH/6A2Uz39GHtmebxfNZezeoyOO5gTvY9O+xjkO8r1YhO28p
hBfNjKaLOB3EBBPsnJRPlLiLdltZJqtVviDL4zvW9/z/br6QIdT2063shwzm1Jcw
jQO5EIKXgGkVSaCGdyOUQEQy9sLxNbl8IRVkWLBsy0k3xWh8n2NUsGqDHUvbL9OG
fINBG1/xThtEzbwDDLpCX/YEkPD0gAloNpH1urExcGMoSpvVL69nTgjUEHC5zF8w
USepsZ4jBfShwaix1t49lmXIn+yHGvKFeag4qwvpHh3CNLYmbSHqnlszhITOj8yP
EfTKznZD1J86/psLffZLyZZWQiLx8MK1ph+WgYPl9/dEJd+fZCoTN33EDmAC2Vq4
RGeDm1Ie3d3z8ku/SMWLJ7THcpE25hquDIh5g1zJOP57AsYc6oLwxAbL07UNnlyE
14qyC1XWota332FQAEgagDBYNYdWH5S3rH01bXZhLDsUzZ0MgTpOR4PMcJLBj00m
omPEW9rdy1/GQ+3t+t9ceIos054iDPDVz11ueYV0sE+EiV21GjmtCInVdhwpF8kg
zG/w7uRhOqOE5zkkJaM1bbcSMhaVpmrmYh8jJnr/ZtVIRj/whFU2VeTtWaSDYqWf
ksPhIYPfniSO1/nUDm6n+QN+JsoP84QG+jBLJlYgbSoHfhn6oigcH5wPwJ6A/0lB
gUYHhTsvMuxHneV617DFQL7YYUXz8zUjWn2pS8pC0VtQniMTKjXgbUTHqDG175Xf
iisBSiFk4BAm9RvkmmRX5rLcJTmDdwpk6BS58Djp2Mc1zjbwcgHUeiHQUt4wW/TN
Nd5y5JUrWOu46vlTrKnHqGXtusM4+LBwp/Lp97xh+oU2nea9v8uls+Af1mra/4+S
8fCjEA0SF4v/I0fM5G2Ijkwp6nkj7wvAMOTthT8tkEZPuKJ8DEVTpFb3hIwlHlSZ
FwIDAQAB
-----END PUBLIC KEY-----
```

まず公開鍵形式に変換

そして色んな方法で秘密鍵を求める

```bash
$ RsaCtfTool --publickey pubkey --private > prikey
$ cat prikey                       
-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----
```

今回はいい感じにクラックできた

秘密鍵の素数の組を表示するためにダンプする

```bash
$ RsaCtfTool --dumpkey --key prikey
[*] n: 708835645943129007553787748743052450284689712410426547512316767085575465605119005363650712704600637109742020195664779931723202832258101240001830121116826860530911023234513730472516558777814474462336333911255324914456970682227084440864891924652593288718973397231251405187335499086751830864753433190350164325435032715196910424344510647893815852428647344971704921938731908848357904590440836622846387392293484370066978446786342914652887905285420452755025164957938321609211830540625620731059401509554003495572595019530165615150268697998771117466990191657016270154492999047417119200543841703801794754017405828083549512181079778484484615833296517041946343398446543929269190267776468727286950763524356091960754388033790771893614211534472337346760709886751505777124848191879137282566717724907881520331796633675057820305038857638609740587193420413455833780473620895200969157817532381746316713116260790229097467695197707645818454306163146665197104753240563079731816779982948701228425085116143519545288954089301901246726186900866685375686284581170642773173724037083247792412468413122298776580153785011292141836456154851500673520085811180879739085766980682690423420251500193172436971000422462776701950480180278285119551587611145499207507237988346524450766967956800772566583568509014882011261077172582310325249831361444584463311832099011527801981194884188239014074127567832579993356109054176333166246338443112763604171839815616178591855308668331998036506593088919047634704264243653775766416884505796755731347878951615701638493886432384698293311079368594952174744155992630039974548983627962173357913806142325163964058180849459998441282429283597135609560729172257355324952390461646717198519551797147369587725325914917663985378963699085381164957289206289790437421994261624932840318105798488050745844673523206172189595340592904205625131517244444161846326215811938527262896842456518748476369372599194582350826419176968609083709232146591659981863052604049246675088415621890060736119217509998775889668347700707715496820780517044443056539542021216759933629382013817643664151620565621489965296266859088600879618054884697023541183586764128250025571103792415266989521147417622218718913326703763590792865947193450841774068689228271097294760531115108569075371337362597498143641843525557229011848404533432494762643735138582308063659307378987402403699137056572585538563072301956067855139155417070021462789594467575592008021731705856812901700315429830350298084022627452025491759562178546139175191
[*] e: 65537
[*] d: 258714140881633975627303705539371875594088498418563605543351344563940447949623061908517708285305205298762975465466858964658422139365759519978695645164021827424193839751126362709654028807625039735402674934117023543247489795365547092871022702255062506159235907377077583839374172424052120089184767717673618424163540939431315094531649216436823095199555129037386235756511089303030670885199884218357349076455439616277860207930319094839511706279311796846059507542211035794930298709610828202190226652250358783802988737158575484297334746114875644747400787104014971422180944156952828040297979668812105078293122166223026753305330245530751667161030451312134466547001561420085127961383846254126735466431215919552332956372251938045611668826839469449845372545143903721391372335470786941712252437246082761895365602293473657044059530871348169657531876898391191907303187692650063052245225972677600375020842548518852120592476450964920234783457016162343634064688866882328838020922412269914459435677222835764885664308956795059610455020350811208728137192450093460706402169263641716808920830094227485783561629880374567537849325175822758298372714702330643131842259760592564936027219503802198641169569942316839505248728386355494753711272389647695859943736838863347862485405888842099646076689738848735706937403876518231783271497967162313708442082772047047892654033915110897906869521932792399188276309796675013976658102056348090971333485680054667294284838656067465916962280797453901596761867210783858264249471057767232192099609613431845528579220341963984865804038455933962348627667691594971425332003442134578787897780991959280157028302134175502850261019719145489667699175564320723731304603751880416450479988487665500680965334730887311843289805759872651162609299744290154153306612641846014283845207387111247033824503967247630017962718270705671914518142988771798336149074310240334984281023872490872105072355323842707317045434021982757734793102685726491946403344351922929504003956418171358913393221232542973516548703786279438873664630009503242489579041102588090607652769835663996700938129269051327963598379028563682403666828004423540753544793085000318305186600032694769658439865749332850834228856407233672648730164496151062122946787465219415051382773633985045827452645358053423603259180606231127990469561425008145354913077469611446256506168120801074377282019443617552391906447959979142003504683074554889054320098908194497354487120436203136168412244961320938685597365062625452947410082901632734593
[*] p: 841923776801159718591870990259839469503514158432469279128085777502132179777253530703491423998696606381985975920867486008017634738670055937793912065195351675867993110797947368849049440827481468183016277163867845938342827823436016267073686760318306015759730476539875259352259622332091703576310399244373311632623577120363709995955195420353362693729365202253052916970875347418939843555660225295819697112161880030119804286206138851798212844660026600584913230489553958418532030952633593806062657682410836792163675656989733429459860604144831257176109198238897035087586347128622999894677277025169668688319690981749170955253998633521030484887735568671940256599714095542226245619675766298022068521105005701971364256008302905400999844407584963028830550803208880112894798476138998978067940299109245475141400123709470698030897263685563999827763860558870324059455580827231603993037155408577138242810927067177853432911146953191319981384713864630396982947712394933697256686519175825307904192359666585105304065517025263915018842148269776342222791566227057541651223158451363004949056929962750580377209980874151895588208247310207286430518186986724731640004381813840370866676798887098662041545143678978089120231788702588351474564495256570081682678607883
[*] q: 841923776801159718591870990259839469503514158432469279128085777502132179777253530703491423998696606381985975920867486008017634738670055937793912065195351675867993110797947368849049440827481468183016277163867845938342827823436016267073686760318306015759730476539875259352259622332091703576310399244373311632623577120363709995955195420353362693729365202253052916970875347418939843555660225295819697112161880030119804286206138851798212844660026600584913230489553958418532030952633593806062657682410836792163675656989733429459860604144831257176109198238897035087586347128622999894677277025169668688319690981749170955253998633521030484887735568671940256599714095542226245619675766298022068521105005701971364256008302905400999844407584963028830550803208880112894798476138998978067940299109245475141400123709470698030897263685563999827763860558870324059455580827231603993037155408577138242810927067177853432911146953191319981384713864630396982947712394933697256686519175825307904192359666585105304065517025263915018842148269776342222791566227057541651223158451363004949056929962750580377209980874151895588208247310207286430518186986724731640004381813840370866676798887098662041545143678978089120231788702588351474564495256570081682678605477
```

これで`d`が求まったので

あとは`enc^d mod n`で平文が求まる

```python
#/usr/bin/env python2

n = 708835645943129007553787748743052450284689712410426547512316767085575465605119005363650712704600637109742020195664779931723202832258101240001830121116826860530911023234513730472516558777814474462336333911255324914456970682227084440864891924652593288718973397231251405187335499086751830864753433190350164325435032715196910424344510647893815852428647344971704921938731908848357904590440836622846387392293484370066978446786342914652887905285420452755025164957938321609211830540625620731059401509554003495572595019530165615150268697998771117466990191657016270154492999047417119200543841703801794754017405828083549512181079778484484615833296517041946343398446543929269190267776468727286950763524356091960754388033790771893614211534472337346760709886751505777124848191879137282566717724907881520331796633675057820305038857638609740587193420413455833780473620895200969157817532381746316713116260790229097467695197707645818454306163146665197104753240563079731816779982948701228425085116143519545288954089301901246726186900866685375686284581170642773173724037083247792412468413122298776580153785011292141836456154851500673520085811180879739085766980682690423420251500193172436971000422462776701950480180278285119551587611145499207507237988346524450766967956800772566583568509014882011261077172582310325249831361444584463311832099011527801981194884188239014074127567832579993356109054176333166246338443112763604171839815616178591855308668331998036506593088919047634704264243653775766416884505796755731347878951615701638493886432384698293311079368594952174744155992630039974548983627962173357913806142325163964058180849459998441282429283597135609560729172257355324952390461646717198519551797147369587725325914917663985378963699085381164957289206289790437421994261624932840318105798488050745844673523206172189595340592904205625131517244444161846326215811938527262896842456518748476369372599194582350826419176968609083709232146591659981863052604049246675088415621890060736119217509998775889668347700707715496820780517044443056539542021216759933629382013817643664151620565621489965296266859088600879618054884697023541183586764128250025571103792415266989521147417622218718913326703763590792865947193450841774068689228271097294760531115108569075371337362597498143641843525557229011848404533432494762643735138582308063659307378987402403699137056572585538563072301956067855139155417070021462789594467575592008021731705856812901700315429830350298084022627452025491759562178546139175191
d = 258714140881633975627303705539371875594088498418563605543351344563940447949623061908517708285305205298762975465466858964658422139365759519978695645164021827424193839751126362709654028807625039735402674934117023543247489795365547092871022702255062506159235907377077583839374172424052120089184767717673618424163540939431315094531649216436823095199555129037386235756511089303030670885199884218357349076455439616277860207930319094839511706279311796846059507542211035794930298709610828202190226652250358783802988737158575484297334746114875644747400787104014971422180944156952828040297979668812105078293122166223026753305330245530751667161030451312134466547001561420085127961383846254126735466431215919552332956372251938045611668826839469449845372545143903721391372335470786941712252437246082761895365602293473657044059530871348169657531876898391191907303187692650063052245225972677600375020842548518852120592476450964920234783457016162343634064688866882328838020922412269914459435677222835764885664308956795059610455020350811208728137192450093460706402169263641716808920830094227485783561629880374567537849325175822758298372714702330643131842259760592564936027219503802198641169569942316839505248728386355494753711272389647695859943736838863347862485405888842099646076689738848735706937403876518231783271497967162313708442082772047047892654033915110897906869521932792399188276309796675013976658102056348090971333485680054667294284838656067465916962280797453901596761867210783858264249471057767232192099609613431845528579220341963984865804038455933962348627667691594971425332003442134578787897780991959280157028302134175502850261019719145489667699175564320723731304603751880416450479988487665500680965334730887311843289805759872651162609299744290154153306612641846014283845207387111247033824503967247630017962718270705671914518142988771798336149074310240334984281023872490872105072355323842707317045434021982757734793102685726491946403344351922929504003956418171358913393221232542973516548703786279438873664630009503242489579041102588090607652769835663996700938129269051327963598379028563682403666828004423540753544793085000318305186600032694769658439865749332850834228856407233672648730164496151062122946787465219415051382773633985045827452645358053423603259180606231127990469561425008145354913077469611446256506168120801074377282019443617552391906447959979142003504683074554889054320098908194497354487120436203136168412244961320938685597365062625452947410082901632734593

enc = 322591498436715958267123572331821134150782373312833612839868183972091497982522254502424703763680659677893580964800124481263656959329041291844931668907981922006294103874302732687771819867000536689111356798002868160412794703860510237214982332623166399791417515634447020777381291741572737475286482402387955568889860510849006181393582267895241983435081092928516146998952546428070356040591091222441571867478829518636745305099389438685499218345311994949366919533514405992167085132436891484719016423868695322095917937144662286686217298236276116502520729941863146291264419980598215299252638364165284561254505052002144225466764890757999340140354815464968914936807483007747763886319359114988020257094791265015476752896816097950499965164665977121072166478126912120191392995885145200726215495052864443599128632447565778113815630862450213198452009283092913820408534896668488757491895594648773475785868743126248865425766947486231885139754067677679827694497407359847002677286914721642080941734074460943717871300727749822488142627660764738931958916578321284940201507349732431865836849470962992660046726630071482205862854896889195384873074978811924398337810859493338888261335608783350859787865548780506929817424121255645044201849812769167381897899206746107940295774070330426141651969490214497458005160894425610680133408097838834931727791441395416689419921586590681939321450680557294644409919786941603526584011483778725713049354543103036628579264137838954115739825810972922036452290642942236775326105221928012882298412629475537706011373606039987837193516925395716996853699337643574189871597092015416413752858780921477119574249340124798992734911070210480513174897301529125757244949387967978001807262978313292663786959333781191335400826006687721998743273129166799171608640918975412729011024061862647570404529985539097149638757568912297491240814100203576132054757632195787968575563075756264486023869531128474496931760838717540249214969524461207774205198875202110020756467071969113970323966817925318851593263086247564335366362069410094398508600362343917062595405077173752873314436451952590173559216945445565839606290258399932695171063789349256390786893722367088255092230898694970298024489038426764778465976027101972512270119323733892682901197765302022045782939507651873114503747563993086728941094162883399015462941621232002246651161343018967033948698908356146449606626585769992033211448852494683033821439838864135940763020321840118595502690340488287721845554876362565957127643512854358250

ans = pow(enc,d,n)
print hex(ans)[2:-1:].decode('hex')
```

```bash
$ python q8.py 
SCKOSEN{Cl0s3_9r1m3_1s_n0t_s4fe}
```

`SCKOSEN{Cl0s3_9r1m3_1s_n0t_s4fe}`